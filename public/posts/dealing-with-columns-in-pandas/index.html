<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Dealing with columns in pandas | XtoPY</title>
<meta name=keywords content="python,pandas,data analytics,data wrangling,excel"><meta name=description content="In this post I go into some uncommon techniques I use every so often to select columns and rows from dataframes in pandas"><meta name=author content="Allwyn"><link rel=canonical href=http://localhost:1313/posts/dealing-with-columns-in-pandas/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/static/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:1313/static/favicon.png><link rel=mask-icon href=http://localhost:1313/static/favicon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/dealing-with-columns-in-pandas/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-MEASUREMENT_ID"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-MEASUREMENT_ID")}</script><meta property="og:title" content="Dealing with columns in pandas"><meta property="og:description" content="In this post I go into some uncommon techniques I use every so often to select columns and rows from dataframes in pandas"><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/posts/dealing-with-columns-in-pandas/"><meta property="og:image" content="http://localhost:1313/static/images/choice.svg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-01-15T16:01:16+05:30"><meta property="article:modified_time" content="2022-01-15T16:01:16+05:30"><meta property="og:site_name" content="XtopY"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/static/images/choice.svg"><meta name=twitter:title content="Dealing with columns in pandas"><meta name=twitter:description content="In this post I go into some uncommon techniques I use every so often to select columns and rows from dataframes in pandas"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"Dealing with columns in pandas","item":"http://localhost:1313/posts/dealing-with-columns-in-pandas/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Dealing with columns in pandas","name":"Dealing with columns in pandas","description":"In this post I go into some uncommon techniques I use every so often to select columns and rows from dataframes in pandas","keywords":["python","pandas","data analytics","data wrangling","excel"],"articleBody":"Why even bother? When working with DataFrames in pandas, I have always missed the ease with which I could select rows and columns in Excel. Simple things like deleting a particular cell or arranging columns were soo incredibly easy and intuitive. Of course Google sheets take this one step further with its fancy editor. I am yet to find such ease of use within pandas.\nIn today‚Äôs post I would like to share a couple of handy techniques I use every soo often to deal with the seemingly simple task of selecting and moving around rows and columns in Pandas.\nThe Basics Setting up our base data Here‚Äôs the base code on top of which I will show all examples:\nimport pandas as pd import numpy as np import re df = pd.read_csv('https://people.sc.fsu.edu/~jburkardt/data/csv/zillow.csv') Vanilla ways of selecting columns Using angle brackets Doing so will create a new df with the columns Index, Beds and Baths\ndf = df[['Index', 'Beds', 'Baths']] Using .get If any column mentioned in the list does not exist, it will return a NONE. This technique is useful for two reasons:\nWhen you need to explicitly and in a human readable way mention which columns you need When the each of the columns mentioned are absolutely necessary. If any one column could not be found in the source df, you get no df in the output. Instead you get a nice little ‚ÄòNone‚Äô\ndf.get(['Index', 'Beds']) df.get(['Index', 'Beds', 'Swimming Pools']) #$ None Filter from existing columns While ‚Äò.get‚Äô returns a ‚ÄòNone‚Äô on a nonexistent column, we can still return whatever other columns were found in the source df, sans the one that wasn‚Äôt\ndf[df.columns[df.columns.isin(['Index', 'Beds', 'Swimming Pools'])]] Filter out unwanted columns Select everything EXCEPT a particular column or a subset of columns. The following code gives us all columns except ‚ÄúBeds‚Äù and ‚ÄúSqft‚Äù\nUsing Difference df[df.columns.difference(['Beds', 'Sqft'])] Using .isin() df[df.columns[~df.columns.isin(['Beds','Sqft'])]] Pro coder ways of selecting columns Selecting based on data type I recently had the good fortune of working with a huge dataset with a decade worth of transactions. One of the things I had to do was select all columns with some pricing information. This technique is a good candidate to show how we could use some better mindful ways to select data en mass. Before you use this technique, I would also suggest getting to know what the data types of each column with:\ndf.dtypes then using another command to automatically converting types or doing it manually\ndf = df.convert_dtypes() Select all columns of type number (64 bit integers to be specific)\ndf.loc[:,(df.dtypes=='int64').values] Note: the required data was a 3 digit integer hence I choose ‚Äòint'64, else we would use more expansive types like float.\nSelect a column based on column names If column name contains a character or word Here the code says: Give me all rows of df for which each column has the word 'price' in it.\ndf.loc[:,['price' in i.lower() for i in df.columns]] If column name starts with a particular character or word (prefix) df.loc[:,[df.columns.str.startswith('S')]] If column name ends with a particular character or word (suffix) df.loc[:,[df.columns.str.endswith('s')]] Exotic ways of selecting columns Now this may not be your everyday use case but I still mention it here for reference. I use it every once in a while and always forget how it works. When it works, it works and you wonder why you didn‚Äôt know this existed.\nSelect the columns if the rows meet a certain condition df.loc[:,[(df[col].mean() \u003e 7) for col in df.columns]] In this we use this thing called list comprehension where we generate a list of columns that meet a certain condition.\nWrapping up I hope these techniques were insightful and more than that, you use them in some project soon. I am always on the look out to improve my game, if you think you have something to add‚Äì either a whole new technique or changes to an existing bit of code, please hit me up on Github or Twitter at @thisAllwyn . You can also join my telegram Channel to interact with other Pythonistas and extend the conversation there üòÑ\n","wordCount":"683","inLanguage":"en","image":"http://localhost:1313/static/images/choice.svg","datePublished":"2022-01-15T16:01:16+05:30","dateModified":"2022-01-15T16:01:16+05:30","author":{"@type":"Person","name":"Allwyn"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/dealing-with-columns-in-pandas/"},"publisher":{"@type":"Organization","name":"XtoPY","logo":{"@type":"ImageObject","url":"http://localhost:1313/static/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="XtoPY (Alt + H)"><img src=http://localhost:1313/static/favicon32.ico alt aria-label=logo height=35>XtoPY</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/categories/ title=categories><span>categories</span></a></li><li><a href=http://localhost:1313/tags/ title=ideas><span>ideas</span></a></li><li><a href=http://localhost:1313/archives/ title=archives><span>archives</span></a></li><li><a href=http://localhost:1313/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Dealing with columns in pandas</h1><div class=post-description>In this post I go into some uncommon techniques I use every so often to select columns and rows from dataframes in pandas</div><div class=post-meta><span title='2022-01-15 16:01:16 +0530 IST'>January 15, 2022</span>&nbsp;¬∑&nbsp;4 min&nbsp;¬∑&nbsp;Allwyn</div></header><figure class=entry-cover><img loading=eager src=http://localhost:1313/static/images/choice.svg alt></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#why-even-bother aria-label="Why even bother?">Why even bother?</a></li><li><a href=#the-basics aria-label="The Basics">The Basics</a><ul><li><a href=#setting-up-our-base-data aria-label="Setting up our base data">Setting up our base data</a></li></ul></li><li><a href=#vanilla-ways-of--selecting-columns aria-label="Vanilla ways of  selecting columns">Vanilla ways of selecting columns</a><ul><li><a href=#using-angle-brackets aria-label="Using angle brackets">Using angle brackets</a></li><li><a href=#using-get aria-label="Using .get">Using .get</a></li><li><a href=#filter-from-existing-columns aria-label="Filter from existing columns">Filter from existing columns</a></li><li><a href=#filter-out-unwanted-columns aria-label="Filter out unwanted columns">Filter out unwanted columns</a><ul><li><a href=#using-difference aria-label="Using Difference">Using Difference</a></li><li><a href=#using-isin aria-label="Using .isin()">Using .isin()</a></li></ul></li></ul></li><li><a href=#pro-coder-ways-of--selecting-columns aria-label="Pro coder ways of  selecting columns">Pro coder ways of selecting columns</a><ul><li><a href=#selecting-based-on-data-type aria-label="Selecting based on data type">Selecting based on data type</a></li><li><a href=#select-a-column-based-on-column-names aria-label="Select a column based on column names">Select a column based on column names</a><ul><li><a href=#if-column-name-contains-a-character-or-word aria-label="If column name contains a character or word">If column name contains a character or word</a></li><li><a href=#if-column-name-starts-with-a-particular-character-or-word-prefix aria-label="If column name starts with a particular character or word (prefix)">If column name starts with a particular character or word (prefix)</a></li><li><a href=#if-column-name-ends-with-a-particular-character-or-word-suffix aria-label="If column name ends with a particular character or word (suffix)">If column name ends with a particular character or word (suffix)</a></li></ul></li></ul></li><li><a href=#exotic-ways-of--selecting-columns aria-label="Exotic ways of  selecting columns">Exotic ways of selecting columns</a><ul><ul><li><a href=#select-the-columns-if-the-rows-meet-a-certain-condition aria-label="Select the columns if the rows meet a certain condition">Select the columns if the rows meet a certain condition</a></li></ul></ul></li><li><a href=#wrapping-up aria-label="Wrapping up">Wrapping up</a></li></ul></div></details></div><div class=post-content><h2 id=why-even-bother>Why even bother?<a hidden class=anchor aria-hidden=true href=#why-even-bother>#</a></h2><p>When working with DataFrames in pandas, I have always missed the ease with which I could select rows and columns in Excel. Simple things like deleting a particular cell or arranging columns were soo incredibly easy and intuitive. Of course Google sheets take this one step further with its fancy editor. I am yet to find such ease of use within pandas.</p><p>In today&rsquo;s post I would like to share a couple of handy techniques I use every soo often to deal with the seemingly simple task of selecting and moving around rows and columns in Pandas.</p><h2 id=the-basics>The Basics<a hidden class=anchor aria-hidden=true href=#the-basics>#</a></h2><h3 id=setting-up-our-base-data>Setting up our base data<a hidden class=anchor aria-hidden=true href=#setting-up-our-base-data>#</a></h3><p>Here&rsquo;s the base code on top of which I will show all examples:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl><span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s1>&#39;https://people.sc.fsu.edu/~jburkardt/data/csv/zillow.csv&#39;</span><span class=p>)</span>
</span></span></code></pre></div><h2 id=vanilla-ways-of--selecting-columns>Vanilla ways of selecting columns<a hidden class=anchor aria-hidden=true href=#vanilla-ways-of--selecting-columns>#</a></h2><h3 id=using-angle-brackets>Using angle brackets<a hidden class=anchor aria-hidden=true href=#using-angle-brackets>#</a></h3><p>Doing so will create a new df with the columns Index, Beds and Baths</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>df</span> <span class=o>=</span> <span class=n>df</span><span class=p>[[</span><span class=s1>&#39;Index&#39;</span><span class=p>,</span> <span class=s1>&#39;Beds&#39;</span><span class=p>,</span> <span class=s1>&#39;Baths&#39;</span><span class=p>]]</span>
</span></span></code></pre></div><h3 id=using-get>Using .get<a hidden class=anchor aria-hidden=true href=#using-get>#</a></h3><p>If any column mentioned in the list does not exist, it will return a NONE.
This technique is useful for two reasons:</p><ol><li>When you need to explicitly and in a human readable way mention which columns you need</li><li>When the each of the columns mentioned are absolutely necessary.</li></ol><p>If any one column could not be found in the source df, you get no df in the output. Instead you get a nice little &lsquo;None&rsquo;</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>df</span><span class=o>.</span><span class=n>get</span><span class=p>([</span><span class=s1>&#39;Index&#39;</span><span class=p>,</span> <span class=s1>&#39;Beds&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>df</span><span class=o>.</span><span class=n>get</span><span class=p>([</span><span class=s1>&#39;Index&#39;</span><span class=p>,</span> <span class=s1>&#39;Beds&#39;</span><span class=p>,</span> <span class=s1>&#39;Swimming Pools&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=c1>#$ None</span>
</span></span></code></pre></div><h3 id=filter-from-existing-columns>Filter from existing columns<a hidden class=anchor aria-hidden=true href=#filter-from-existing-columns>#</a></h3><p>While &lsquo;.get&rsquo; returns a &lsquo;None&rsquo; on a nonexistent column, we can still return whatever other columns were found in the source df, sans the one that wasn&rsquo;t</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>df</span><span class=p>[</span><span class=n>df</span><span class=o>.</span><span class=n>columns</span><span class=p>[</span><span class=n>df</span><span class=o>.</span><span class=n>columns</span><span class=o>.</span><span class=n>isin</span><span class=p>([</span><span class=s1>&#39;Index&#39;</span><span class=p>,</span> <span class=s1>&#39;Beds&#39;</span><span class=p>,</span> <span class=s1>&#39;Swimming Pools&#39;</span><span class=p>])]]</span>
</span></span></code></pre></div><h3 id=filter-out-unwanted-columns>Filter out unwanted columns<a hidden class=anchor aria-hidden=true href=#filter-out-unwanted-columns>#</a></h3><p>Select everything <strong>EXCEPT</strong> a particular column or a subset of columns.
The following code gives us all columns except &ldquo;Beds&rdquo; and &ldquo;Sqft&rdquo;</p><h4 id=using-difference>Using Difference<a hidden class=anchor aria-hidden=true href=#using-difference>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>df</span><span class=p>[</span><span class=n>df</span><span class=o>.</span><span class=n>columns</span><span class=o>.</span><span class=n>difference</span><span class=p>([</span><span class=s1>&#39;Beds&#39;</span><span class=p>,</span> <span class=s1>&#39;Sqft&#39;</span><span class=p>])]</span>
</span></span></code></pre></div><h4 id=using-isin>Using .isin()<a hidden class=anchor aria-hidden=true href=#using-isin>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>df</span><span class=p>[</span><span class=n>df</span><span class=o>.</span><span class=n>columns</span><span class=p>[</span><span class=o>~</span><span class=n>df</span><span class=o>.</span><span class=n>columns</span><span class=o>.</span><span class=n>isin</span><span class=p>([</span><span class=s1>&#39;Beds&#39;</span><span class=p>,</span><span class=s1>&#39;Sqft&#39;</span><span class=p>])]]</span>
</span></span></code></pre></div><h2 id=pro-coder-ways-of--selecting-columns>Pro coder ways of selecting columns<a hidden class=anchor aria-hidden=true href=#pro-coder-ways-of--selecting-columns>#</a></h2><h3 id=selecting-based-on-data-type>Selecting based on data type<a hidden class=anchor aria-hidden=true href=#selecting-based-on-data-type>#</a></h3><p>I recently had the good fortune of working with a huge dataset with a decade worth of transactions. One of the things I had to do was select all columns with some pricing information. This technique is a good candidate to show how we could use some better mindful ways to select data en mass.
Before you use this technique, I would also suggest getting to know what the data types of each column with:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>df</span><span class=o>.</span><span class=n>dtypes</span>
</span></span></code></pre></div><p>then using another command to automatically converting types or doing it manually</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>df</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>convert_dtypes</span><span class=p>()</span>
</span></span></code></pre></div><p>Select all columns of type number (64 bit integers to be specific)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[:,(</span><span class=n>df</span><span class=o>.</span><span class=n>dtypes</span><span class=o>==</span><span class=s1>&#39;int64&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>values</span><span class=p>]</span>
</span></span></code></pre></div><p>Note: the required data was a 3 digit integer hence I choose &lsquo;int'64, else we would use more expansive types like float.</p><h3 id=select-a-column-based-on-column-names>Select a column based on column names<a hidden class=anchor aria-hidden=true href=#select-a-column-based-on-column-names>#</a></h3><h4 id=if-column-name-contains-a-character-or-word>If column name contains a character or word<a hidden class=anchor aria-hidden=true href=#if-column-name-contains-a-character-or-word>#</a></h4><p>Here the code says: Give me all rows of <code>df</code> for which each column has the word <code>'price'</code> in it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[:,[</span><span class=s1>&#39;price&#39;</span> <span class=ow>in</span> <span class=n>i</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>df</span><span class=o>.</span><span class=n>columns</span><span class=p>]]</span>
</span></span></code></pre></div><h4 id=if-column-name-starts-with-a-particular-character-or-word-prefix>If column name starts with a particular character or word (prefix)<a hidden class=anchor aria-hidden=true href=#if-column-name-starts-with-a-particular-character-or-word-prefix>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[:,[</span><span class=n>df</span><span class=o>.</span><span class=n>columns</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s1>&#39;S&#39;</span><span class=p>)]]</span>
</span></span></code></pre></div><h4 id=if-column-name-ends-with-a-particular-character-or-word-suffix>If column name ends with a particular character or word (suffix)<a hidden class=anchor aria-hidden=true href=#if-column-name-ends-with-a-particular-character-or-word-suffix>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[:,[</span><span class=n>df</span><span class=o>.</span><span class=n>columns</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>endswith</span><span class=p>(</span><span class=s1>&#39;s&#39;</span><span class=p>)]]</span>
</span></span></code></pre></div><h2 id=exotic-ways-of--selecting-columns>Exotic ways of selecting columns<a hidden class=anchor aria-hidden=true href=#exotic-ways-of--selecting-columns>#</a></h2><p>Now this may not be your everyday use case but I still mention it here for reference. I use it every once in a while and always forget how it works. When it works, it works and you wonder why you didn&rsquo;t know this existed.</p><h4 id=select-the-columns-if-the-rows-meet-a-certain-condition>Select the columns if the rows meet a certain condition<a hidden class=anchor aria-hidden=true href=#select-the-columns-if-the-rows-meet-a-certain-condition>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[:,[(</span><span class=n>df</span><span class=p>[</span><span class=n>col</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span> <span class=o>&gt;</span> <span class=mi>7</span><span class=p>)</span> <span class=k>for</span> <span class=n>col</span> <span class=ow>in</span> <span class=n>df</span><span class=o>.</span><span class=n>columns</span><span class=p>]]</span>
</span></span></code></pre></div><p>In this we use this thing called <code>list comprehension</code> where we generate a list of columns that meet a certain condition.</p><h2 id=wrapping-up>Wrapping up<a hidden class=anchor aria-hidden=true href=#wrapping-up>#</a></h2><p>I hope these techniques were insightful and more than that, you use them in some project soon.
I am always on the look out to improve my game, if you think you have something to add&ndash; either a whole new technique or changes to an existing bit of code, please hit me up on Github or Twitter at <a href=https://twitter.com/thisallwyn>@thisAllwyn</a> .
You can also join my telegram Channel to interact with other Pythonistas and extend the conversation there üòÑ</p></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/python/>Python</a></li><li><a href=http://localhost:1313/tags/pandas/>Pandas</a></li><li><a href=http://localhost:1313/tags/data-analytics/>Data Analytics</a></li><li><a href=http://localhost:1313/tags/data-wrangling/>Data Wrangling</a></li><li><a href=http://localhost:1313/tags/excel/>Excel</a></li></ul><nav class=paginav><a class=prev href=http://localhost:1313/posts/a-quick-guide-to-the-basics-of-statistics/><span class=title>¬´ Prev</span><br><span>Statistics for Beginners</span>
</a><a class=next href=http://localhost:1313/posts/a-quick-guide-to-sales-prediction-using-pandas/><span class=title>Next ¬ª</span><br><span></span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Dealing with columns in pandas on x" href="https://x.com/intent/tweet/?text=Dealing%20with%20columns%20in%20pandas&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fdealing-with-columns-in-pandas%2f&amp;hashtags=python%2cpandas%2cdataanalytics%2cdatawrangling%2cexcel"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Dealing with columns in pandas on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fdealing-with-columns-in-pandas%2f&amp;title=Dealing%20with%20columns%20in%20pandas&amp;summary=Dealing%20with%20columns%20in%20pandas&amp;source=http%3a%2f%2flocalhost%3a1313%2fposts%2fdealing-with-columns-in-pandas%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Dealing with columns in pandas on reddit" href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fposts%2fdealing-with-columns-in-pandas%2f&title=Dealing%20with%20columns%20in%20pandas"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Dealing with columns in pandas on facebook" href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fposts%2fdealing-with-columns-in-pandas%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Dealing with columns in pandas on whatsapp" href="https://api.whatsapp.com/send?text=Dealing%20with%20columns%20in%20pandas%20-%20http%3a%2f%2flocalhost%3a1313%2fposts%2fdealing-with-columns-in-pandas%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Dealing with columns in pandas on telegram" href="https://telegram.me/share/url?text=Dealing%20with%20columns%20in%20pandas&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fdealing-with-columns-in-pandas%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Dealing with columns in pandas on ycombinator" href="https://news.ycombinator.com/submitlink?t=Dealing%20with%20columns%20in%20pandas&u=http%3a%2f%2flocalhost%3a1313%2fposts%2fdealing-with-columns-in-pandas%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=http://localhost:1313/>XtoPY</a></span> ¬∑
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>